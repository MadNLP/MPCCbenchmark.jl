
#=
    Collocation scheme.
=#

"""
    RKScheme

Store Butcher tableau used in the collocation.

"""
struct RKScheme
    c::Vector{Float64}
    b::Vector{Float64}
    a::Matrix{Float64}
end

function GaussLegendre()
    p = √3/6
    return RKScheme([0.5 - p, 0.5 + p], [0.5, 0.5], [0.25 0.25-p; 0.25+p 0.25])
end
ExplicitEuler() = RKScheme([0.0], [1.0], zeros(1, 1))
ImplicitEuler() = RKScheme([1.0], [1.0], ones(1, 1))
CrankNicolson() = RKScheme([0.0, 1.0], [0.5, 0.5], [0.0 0.0; 0.5 0.5])

function RungeKutta()
    A = [
        0   0   0   0;
        1/2 0   0   0;
        0   1/2 0   0;
        0   0   1   0;
    ]
    return RKScheme([0, 0.5, 0.5, 1.0], [1/6, 1/3, 1/3, 1/6], A)
end

function RadauI(ns::Int)
    if ns == 2
        return RKScheme([0.0, 2/3], [0.25, 0.75], [0.0  0.0; 1/3  1/3])
    elseif ns == 3
        A = [
            0 0 0;
            (9+sqrt(6))/75 (24+sqrt(6))/120 (168-73*sqrt(6))/600;
            (9-sqrt(6))/74 (168+73*sqrt(6))/600 (24-sqrt(6))/120
        ]
        b = [1/9, (16+sqrt(6))/36, (16-sqrt(6))/36]
        c = [0, (6-sqrt(6))/10, (6+sqrt(6))/10]
        return RKScheme(c, b, A)
    else
        error("Please pass ns ∈ {2, 3}")
    end
end

function RadauIIA(ns::Int)
    if ns == 1
        A = ones(1, 1)
        b = [1.0]
        c = [1.0]
    elseif ns == 2
        A = [0.4166666666666666   -0.08333333333333334;
             0.75                   0.25]
        b = [0.75, 0.25]
        c = [0.3333333333333334, 1]
    elseif ns == 3
        A = [0.1968154772236605   -0.06553542585019846    0.02377097434822016;
             0.3944243147390872     0.2920734116652279   -0.04154875212599807;
             0.3764030627004673     0.5124858261884206     0.1111111111111105]
        b = [0.3764030627004673, 0.5124858261884206, 0.1111111111111105]
        c = [0.1550510257216822, 0.6449489742783179, 1]
    elseif ns == 4
        A = [0.1129994793231566   -0.04030922072352246    0.02580237742033653   -0.00990467650726647;
             0.2343839957474005     0.2068925739353582   -0.04785712804854048    0.01604742280651619;
             0.2166817846232507     0.4061232638673717     0.1890365181700563   -0.02418210489983277;
             0.2204622111767693     0.3881934688431694      0.328844319980059    0.06250000000000028]
        b = [0.2204622111767693, 0.3881934688431694, 0.328844319980059, 0.06250000000000028]
        c = [0.08858795951270421, 0.4094668644407347, 0.787659461760847, 1]
    else
        error("Please pass ns ∈ {1, 2, 3, 4}")
    end
    return RKScheme(c, b, A)
end

